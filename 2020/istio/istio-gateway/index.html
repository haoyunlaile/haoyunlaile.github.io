<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"haoyunlaile.github.io","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":true,"nav":{"disqus":{"text":"Load Comment","order":-1}},"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Istio  Ingress gateway 网关 ​                                                                    Istio 服务网格中的网关  使用网关为网格来管理入站和出站流量，可以让用户指定要进入或离开网格的流量。 网关配置被用于运行在网格内独立 Envoy 代理中，而不是服务工作负载的应用 Sidecar 代理。">
<meta property="og:type" content="article">
<meta property="og:title" content="Istio Gateway">
<meta property="og:url" content="http://haoyunlaile.github.io/2020/istio/istio-gateway/index.html">
<meta property="og:site_name" content="好运来了">
<meta property="og:description" content="Istio  Ingress gateway 网关 ​                                                                    Istio 服务网格中的网关  使用网关为网格来管理入站和出站流量，可以让用户指定要进入或离开网格的流量。 网关配置被用于运行在网格内独立 Envoy 代理中，而不是服务工作负载的应用 Sidecar 代理。">
<meta property="og:image" content="http://haoyunlaile.github.io/images/istio-gateways.svg">
<meta property="article:published_time" content="2020-04-26T16:00:00.000Z">
<meta property="article:modified_time" content="2020-04-26T16:00:00.000Z">
<meta property="article:author" content="好运来了">
<meta property="article:tag" content="istio">
<meta property="article:tag" content="istio-gateway">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://haoyunlaile.github.io/images/istio-gateways.svg">

<link rel="canonical" href="http://haoyunlaile.github.io/2020/istio/istio-gateway/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Istio Gateway | 好运来了</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?55ae289b7e76ebbe6ab20e60c74bad9d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="好运来了" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">好运来了</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">分享知识、记录点滴</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://haoyunlaile.github.io/2020/istio/istio-gateway/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/50016783?s=400&u=a5ed1b51def3b9af69486f1f197f4725b370a03c&v=4">
      <meta itemprop="name" content="好运来了">
      <meta itemprop="description" content="java,go,istio,mosn,service mesh">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="好运来了">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Istio Gateway
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-27 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-27T00:00:00+08:00">2020-04-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/istio/" itemprop="url" rel="index"><span itemprop="name">istio</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/istio/istio-gateway/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/istio/istio-gateway/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="Istio-Ingress-gateway-网关"><a href="#Istio-Ingress-gateway-网关" class="headerlink" title="Istio  Ingress gateway 网关"></a>Istio  Ingress gateway 网关</h2><p><img data-src="/images/istio-gateways.svg" alt="istio-gateways"></p>
<p>​                                                                    <em>Istio 服务网格中的网关</em> </p>
<p>使用网关为网格来管理入站和出站流量，可以让用户指定要进入或离开网格的流量。</p>
<p>网关配置被用于运行在网格内独立 Envoy 代理中，而不是服务工作负载的应用 Sidecar 代理。</p>
<p> <a href="https://preliminary.istio.io/zh/docs/reference/config/networking/gateway/" target="_blank" rel="noopener"><code>Gateway</code></a> 用于为 HTTP / TCP 流量配置负载均衡器，并不管该负载均衡器将在哪里运行。网格中可以存在任意数量的 <a href="https://preliminary.istio.io/zh/docs/reference/config/networking/gateway/" target="_blank" rel="noopener"><code>Gateway</code></a>，并且多个不同的 <a href="https://preliminary.istio.io/zh/docs/reference/config/networking/gateway/" target="_blank" rel="noopener"><code>Gateway</code></a> 实现可以共存。实际上，通过在配置中指定一组工作负载（Pod）标签，可以将 Gateway 配置绑定到特定的工作负载，从而允许用户通过编写简单的 Gateway Controller 来重用现成的网络设备。</p>
<p><code>Gateway</code> 只用于配置 L4-L6 功能（例如，对外公开的端口，TLS 配置），所有主流的 L7 代理均以统一的方式实现了这些功能。然后，通过在 <code>Gateway</code> 上绑定 <code>VirtualService</code> 的方式，可以使用标准的 Istio 规则来控制进入 <code>Gateway</code> 的 HTTP 和 TCP 流量。 </p>
<a id="more"></a> 

<p>例如，下面这个简单的 <code>Gateway</code> 配置了一个 Load Balancer，以允许访问 host <code>bookinfo.com</code> 的 https 外部流量进入网格中： </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Gateway</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">bookinfo-gateway</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">my-ingress-gateway</span></span><br><span class="line">  <span class="attr">servers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span></span><br><span class="line">      <span class="attr">number:</span> <span class="number">443</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">https</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">HTTPS</span></span><br><span class="line">    <span class="attr">hosts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">bookinfo.com</span></span><br><span class="line">    <span class="attr">tls:</span></span><br><span class="line">      <span class="attr">mode:</span> <span class="string">SIMPLE</span></span><br><span class="line">      <span class="attr">serverCertificate:</span> <span class="string">/tmp/tls.crt</span></span><br><span class="line">      <span class="attr">privateKey:</span> <span class="string">/tmp/tls.key</span></span><br></pre></td></tr></table></figure>

<p> 要为进入上面的 Gateway 的流量配置相应的路由，必须为同一个 host 定义一个 <code>VirtualService</code>（在下一节中描述），并使用配置中的 <code>gateways</code> 字段绑定到前面定义的 <code>Gateway</code> 上： </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">bookinfo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">bookinfo.com</span></span><br><span class="line">  <span class="attr">gateways:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">bookinfo-gateway</span> <span class="comment"># &lt;---- bind to gateway</span></span><br><span class="line">    <span class="attr">http:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">match:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uri:</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">/reviews</span></span><br><span class="line">    <span class="attr">route:</span></span><br><span class="line">    <span class="string">...</span></span><br></pre></td></tr></table></figure>

<p>然后就可以为出口流量配置带有路由规则的虚拟服务。 </p>
<h3 id="Gateway-配置信息"><a href="#Gateway-配置信息" class="headerlink" title="Gateway 配置信息"></a><code>Gateway</code> 配置信息</h3><table>
<thead>
<tr>
<th>ield</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td>servers</td>
<td>Server[]</td>
<td>A list of server specifications.</td>
<td>Yes</td>
</tr>
<tr>
<td>selector</td>
<td>map</td>
<td>One or more labels that indicate a specific set of pods/VMs on which this gateway configuration should be applied. The scope of label search is restricted to the configuration namespace in which the the resource is present. In other words, the Gateway resource must reside in the same namespace as the gateway workload instance.</td>
<td>Yes</td>
</tr>
</tbody></table>
<h3 id="Server-配置信息"><a href="#Server-配置信息" class="headerlink" title="Server 配置信息"></a><code>Server</code> 配置信息</h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td><code>port</code></td>
<td><code>Port</code></td>
<td>The Port on which the proxy should listen for incoming connections.</td>
<td>Yes</td>
</tr>
<tr>
<td><code>hosts</code></td>
<td><code>string[]</code></td>
<td>One or more hosts exposed by this gateway. While typically applicable to HTTP services, it can also be used for TCP services using TLS with SNI. A host is specified as a <code>dnsName</code> with an optional <code>namespace/</code> prefix. The <code>dnsName</code> should be specified using FQDN format, optionally including a wildcard character in the left-most component (e.g., <code>prod/*.example.com</code>). Set the <code>dnsName</code> to <code>*</code> to select all <code>VirtualService</code> hosts from the specified namespace (e.g.,<code>prod/*</code>).The <code>namespace</code> can be set to <code>*</code> or <code>.</code>, representing any or the current namespace, respectively. For example, <code>*/foo.example.com</code> selects the service from any available namespace while <code>./foo.example.com</code> only selects the service from the namespace of the sidecar. The default, if no <code>namespace/</code> is specified, is <code>*/</code>, that is, select services from any namespace. Any associated <code>DestinationRule</code> in the selected namespace will also be used.A <code>VirtualService</code> must be bound to the gateway and must have one or more hosts that match the hosts specified in a server. The match could be an exact match or a suffix match with the server’s hosts. For example, if the server’s hosts specifies <code>*.example.com</code>, a <code>VirtualService</code> with hosts <code>dev.example.com</code> or <code>prod.example.com</code> will match. However, a <code>VirtualService</code> with host <code>example.com</code> or <code>newexample.com</code> will not match.NOTE: Only virtual services exported to the gateway’s namespace (e.g., <code>exportTo</code> value of <code>*</code>) can be referenced. Private configurations (e.g., <code>exportTo</code> set to <code>.</code>) will not be available. Refer to the <code>exportTo</code> setting in <code>VirtualService</code>, <code>DestinationRule</code>, and <code>ServiceEntry</code> configurations for details.</td>
<td>Yes</td>
</tr>
<tr>
<td><code>tls</code></td>
<td><code>TLSOptions</code></td>
<td>Set of TLS related options that govern the server’s behavior. Use these options to control if all http requests should be redirected to https, and the TLS modes to use.</td>
<td>No</td>
</tr>
<tr>
<td><code>defaultEndpoint</code></td>
<td><code>string</code></td>
<td>The loopback IP endpoint or Unix domain socket to which traffic should be forwarded to by default. Format should be <code>127.0.0.1:PORT</code> or <code>unix:///path/to/socket</code> or <code>unix://@foobar</code> (Linux abstract namespace).</td>
<td>No</td>
</tr>
</tbody></table>
<h3 id="Port-配置信息"><a href="#Port-配置信息" class="headerlink" title="Port 配置信息"></a><code>Port</code> 配置信息</h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td><code>number</code></td>
<td><code>uint32</code></td>
<td>A valid non-negative integer port number.</td>
<td>Yes</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>The protocol exposed on the port. MUST BE one of HTTP|HTTPS|GRPC|HTTP2|MONGO|TCP|TLS. TLS implies the connection will be routed based on the SNI header to the destination without terminating the TLS connection.</td>
<td>Yes</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Label assigned to the port.</td>
<td>No</td>
</tr>
</tbody></table>
<h3 id="Server-TLSOptions-配置信息"><a href="#Server-TLSOptions-配置信息" class="headerlink" title="Server.TLSOptions 配置信息"></a><code>Server.TLSOptions</code> 配置信息</h3><table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td><code>httpsRedirect</code></td>
<td><code>bool</code></td>
<td>If set to true, the load balancer will send a 301 redirect for all http connections, asking the clients to use HTTPS.</td>
<td>No</td>
</tr>
<tr>
<td><code>mode</code></td>
<td><code>TLSmode</code></td>
<td>Optional: Indicates whether connections to this port should be secured using TLS. The value of this field determines how TLS is enforced.</td>
<td>No</td>
</tr>
<tr>
<td><code>serverCertificate</code></td>
<td><code>string</code></td>
<td>REQUIRED if mode is <code>SIMPLE</code> or <code>MUTUAL</code>. The path to the file holding the server-side TLS certificate to use.</td>
<td>No</td>
</tr>
<tr>
<td><code>privateKey</code></td>
<td><code>string</code></td>
<td>REQUIRED if mode is <code>SIMPLE</code> or <code>MUTUAL</code>. The path to the file holding the server’s private key.</td>
<td>No</td>
</tr>
<tr>
<td><code>caCertificates</code></td>
<td><code>string</code></td>
<td>REQUIRED if mode is <code>MUTUAL</code>. The path to a file containing certificate authority certificates to use in verifying a presented client side certificate.</td>
<td>No</td>
</tr>
<tr>
<td><code>credentialName</code></td>
<td><code>string</code></td>
<td>The credentialName stands for a unique identifier that can be used to identify the serverCertificate and the privateKey. The credentialName appended with suffix “-cacert” is used to identify the CaCertificates associated with this server. Gateway workloads capable of fetching credentials from a remote credential store such as Kubernetes secrets, will be configured to retrieve the serverCertificate and the privateKey using credentialName, instead of using the file system paths specified above. If using mutual TLS, gateway workload instances will retrieve the CaCertificates using credentialName-cacert. The semantics of the name are platform dependent. In Kubernetes, the default Istio supplied credential server expects the credentialName to match the name of the Kubernetes secret that holds the server certificate, the private key, and the CA certificate (if using mutual TLS). Set the <code>ISTIO_META_USER_SDS</code> metadata variable in the gateway’s proxy to enable the dynamic credential fetching feature.</td>
<td>No</td>
</tr>
<tr>
<td><code>subjectAltNames</code></td>
<td><code>string[]</code></td>
<td>A list of alternate names to verify the subject identity in the certificate presented by the client.</td>
<td>No</td>
</tr>
<tr>
<td><code>verifyCertificateSpki</code></td>
<td><code>string[]</code></td>
<td>An optional list of base64-encoded SHA-256 hashes of the SKPIs of authorized client certificates. Note: When both verify<em>certificate</em>hash and verify<em>certificate</em>spki are specified, a hash matching either value will result in the certificate being accepted.</td>
<td>No</td>
</tr>
<tr>
<td><code>verifyCertificateHash</code></td>
<td><code>string[]</code></td>
<td>An optional list of hex-encoded SHA-256 hashes of the authorized client certificates. Both simple and colon separated formats are acceptable. Note: When both verify<em>certificate</em>hash and verify<em>certificate</em>spki are specified, a hash matching either value will result in the certificate being accepted.</td>
<td>No</td>
</tr>
<tr>
<td><code>minProtocolVersion</code></td>
<td><code>TLSProtocol</code></td>
<td>Optional: Minimum TLS protocol version.</td>
<td>No</td>
</tr>
<tr>
<td><code>maxProtocolVersion</code></td>
<td><code>TLSProtocol</code></td>
<td>Optional: Maximum TLS protocol version.</td>
<td>No</td>
</tr>
<tr>
<td><code>cipherSuites</code></td>
<td><code>string[]</code></td>
<td>Optional: If specified, only support the specified cipher list. Otherwise default to the default cipher list supported by Envoy.</td>
<td>No</td>
</tr>
</tbody></table>
<h3 id="Server-TLSOptions-TLSmode-配置信息"><a href="#Server-TLSOptions-TLSmode-配置信息" class="headerlink" title="Server.TLSOptions.TLSmode 配置信息"></a><code>Server.TLSOptions.TLSmode</code> 配置信息</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>PASSTHROUGH</code></td>
<td>The SNI string presented by the client will be used as the match criterion in a VirtualService TLS route to determine the destination service from the service registry.</td>
</tr>
<tr>
<td><code>SIMPLE</code></td>
<td>Secure connections with standard TLS semantics.</td>
</tr>
<tr>
<td><code>MUTUAL</code></td>
<td>Secure connections to the downstream using mutual TLS by presenting server certificates for authentication.</td>
</tr>
<tr>
<td><code>AUTO_PASSTHROUGH</code></td>
<td>Similar to the passthrough mode, except servers with this TLS mode do not require an associated VirtualService to map from the SNI value to service in the registry. The destination details such as the service/subset/port are encoded in the SNI value. The proxy will forward to the upstream (Envoy) cluster (a group of endpoints) specified by the SNI value. This server is typically used to provide connectivity between services in disparate L3 networks that otherwise do not have direct connectivity between their respective endpoints. Use of this mode assumes that both the source and the destination are using Istio mTLS to secure traffic.</td>
</tr>
<tr>
<td><code>ISTIO_MUTUAL</code></td>
<td>Secure connections from the downstream using mutual TLS by presenting server certificates for authentication. Compared to Mutual mode, this mode uses certificates, representing gateway workload identity, generated automatically by Istio for mTLS authentication. When this mode is used, all other fields in <code>TLSOptions</code> should be empty.</td>
</tr>
</tbody></table>
<h3 id="Server-TLSOptions-TLSProtocol-配置信息"><a href="#Server-TLSOptions-TLSProtocol-配置信息" class="headerlink" title="Server.TLSOptions.TLSProtocol 配置信息"></a><code>Server.TLSOptions.TLSProtocol</code> 配置信息</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>TLS_AUTO</code></td>
<td>Automatically choose the optimal TLS version.</td>
</tr>
<tr>
<td><code>TLSV1_0</code></td>
<td>TLS version 1.0</td>
</tr>
<tr>
<td><code>TLSV1_1</code></td>
<td>TLS version 1.1</td>
</tr>
<tr>
<td><code>TLSV1_2</code></td>
<td>TLS version 1.2</td>
</tr>
<tr>
<td><code>TLSV1_3</code></td>
<td>TLS version 1.3</td>
</tr>
</tbody></table>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p> <a href="https://preliminary.istio.io/zh/docs/concepts/traffic-management/#gateways" target="_blank" rel="noopener">https://preliminary.istio.io/zh/docs/concepts/traffic-management/#gateways</a> </p>
<p> <a href="https://preliminary.istio.io/zh//blog/2018/v1alpha3-routing/" target="_blank" rel="noopener">https://preliminary.istio.io/zh//blog/2018/v1alpha3-routing/</a></p>
<p> <a href="https://preliminary.istio.io/zh/docs/reference/config/networking/gateway/#Gateway" target="_blank" rel="noopener">https://preliminary.istio.io/zh/docs/reference/config/networking/gateway/#Gateway</a> </p>

    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

            <div class="social-item">
              <a target="_blank" class="social-link" href="/atom.xml">
                <span class="icon">
                  <i class="fa fa-rss"></i>
                </span>

                <span class="label">RSS</span>
              </a>
            </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/istio/" rel="tag"><i class="fa fa-tag"></i> istio</a>
              <a href="/tags/istio-gateway/" rel="tag"><i class="fa fa-tag"></i> istio-gateway</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/istio/istio-port/" rel="prev" title="Istio 使用的端口">
      <i class="fa fa-chevron-left"></i> Istio 使用的端口
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/istio/istio-virtualservice/" rel="next" title="Istio VirtualService">
      Istio VirtualService <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Istio-Ingress-gateway-网关"><span class="nav-number">1.</span> <span class="nav-text">Istio  Ingress gateway 网关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Gateway-配置信息"><span class="nav-number">1.1.</span> <span class="nav-text">Gateway 配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Server-配置信息"><span class="nav-number">1.2.</span> <span class="nav-text">Server 配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Port-配置信息"><span class="nav-number">1.3.</span> <span class="nav-text">Port 配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Server-TLSOptions-配置信息"><span class="nav-number">1.4.</span> <span class="nav-text">Server.TLSOptions 配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Server-TLSOptions-TLSmode-配置信息"><span class="nav-number">1.5.</span> <span class="nav-text">Server.TLSOptions.TLSmode 配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Server-TLSOptions-TLSProtocol-配置信息"><span class="nav-number">1.6.</span> <span class="nav-text">Server.TLSOptions.TLSProtocol 配置信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考文献"><span class="nav-number">2.</span> <span class="nav-text">参考文献</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="好运来了"
      src="https://avatars3.githubusercontent.com/u/50016783?s=400&u=a5ed1b51def3b9af69486f1f197f4725b370a03c&v=4">
  <p class="site-author-name" itemprop="name">好运来了</p>
  <div class="site-description" itemprop="description">java,go,istio,mosn,service mesh</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/haoyunlaile" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;haoyunlaile" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">好运来了</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  <script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js"></script>
    <script defer src="//cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js"></script>


  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>















  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://haoyunlaile.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://haoyunlaile.github.io/2020/istio/istio-gateway/";
    this.page.identifier = "2020/istio/istio-gateway/";
    this.page.title = "Istio Gateway";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://haoyunlaile.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
