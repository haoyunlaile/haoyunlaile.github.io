<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>好运来了</title>
  
  <subtitle>分享知识、记录点滴</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://haoyunlaile.github.io/"/>
  <updated>2020-03-06T07:42:29.000Z</updated>
  <id>http://haoyunlaile.github.io/</id>
  
  <author>
    <name>好运来了</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>快速部署 Shadowsocks Docker版</title>
    <link href="http://haoyunlaile.github.io/2020/03/06/docker-install-shadowsocks-libev/"/>
    <id>http://haoyunlaile.github.io/2020/03/06/docker-install-shadowsocks-libev/</id>
    <published>2020-03-06T07:42:29.000Z</published>
    <updated>2020-03-06T07:42:29.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>搭梯子翻墙访问google</p><h2 id="准备条件"><a href="#准备条件" class="headerlink" title="准备条件"></a>准备条件</h2><ol><li>一台墙外VPS（本文使用腾讯云香港 - centos7.6）</li><li>一台能SSH连接到VPS的本地电脑 （推荐连接工具xshell）</li></ol><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>因为在腾讯上直接安装使用shadowsocks遇到了”connect reset by peer”的问题，在公司访问(可直连境外)是正常的，用4g/家里wifi访问就会出现上述错误，怀疑是腾讯云做了相关网站的流量拦截，故想到这用docker再代理一层。</p><h2 id="服务端安装步骤"><a href="#服务端安装步骤" class="headerlink" title="服务端安装步骤"></a>服务端安装步骤</h2><p>安装docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -qO- get.docker.com | bash</span><br></pre></td></tr></table></figure><p>查看docker的版本信息、加入开启启动、启动docker应用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><p>拉取docker版shadowsocks-libev</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull appso/shadowsocks-libev</span><br></pre></td></tr></table></figure><p>创建shadowssocks配置文件，主要不要变动配置文件目录，默认配置路径为 <strong>/etc/shadowsocks-libev/config.json</strong></p>  <a id="more"></a> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/shadowsocks-libev/</span><br><span class="line">touch /etc/shadowsocks-libev/config.json</span><br><span class="line">vi /etc/shadowsocks-libev/config.json</span><br></pre></td></tr></table></figure><p>config.json 配置内容</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="attr">"server_port"</span>:<span class="number">443</span>,</span><br><span class="line">    <span class="attr">"password"</span>:<span class="string">"your client connection password"</span>,</span><br><span class="line">    <span class="attr">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"aes-256-gcm"</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"mode"</span>:<span class="string">"tcp_and_udp"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">名称</th><th align="center">解释</th></tr></thead><tbody><tr><td align="center">server</td><td align="center">服务端监听地址</td></tr><tr><td align="center">server_port</td><td align="center">客户端用于连接的端口</td></tr><tr><td align="center">password</td><td align="center">客户端用于连接的密码</td></tr><tr><td align="center">timeout</td><td align="center">超时时间</td></tr><tr><td align="center">method</td><td align="center">默认为 <code>aes-256-cfb</code>，参阅 <a href="https://github.com/shadowsocks/shadowsocks/wiki/Encryption" target="_blank" rel="noopener">Encryption</a></td></tr><tr><td align="center">mode</td><td align="center">是否启用 TCP / UDP 转发，参阅 <a href="https://jlk.fjfi.cvut.cz/arch/manpages/man/shadowsocks-libev.8" target="_blank" rel="noopener">shadowsocks-libev(8)</a></td></tr><tr><td align="center">fast_open</td><td align="center">是否启用 <a href="https://github.com/shadowsocks/shadowsocks/wiki/TCP-Fast-Open" target="_blank" rel="noopener">TCP Fast Open</a></td></tr></tbody></table><p>使用docker启动shadowsocks</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 443:443 -p 443:443/udp --name ss-libev -v /etc/shadowsocks-libev:/etc/shadowsocks-libev appso/shadowsocks-libev</span><br></pre></td></tr></table></figure><p>查看容器启动状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@007_centos ~]<span class="comment"># docker ps -as</span></span><br><span class="line">CONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS                  PORTS                                        NAMES               SIZE</span><br><span class="line">84c3fd45cbea        appso/shadowsocks-libev   <span class="string">"ss-server -c /etc/s…"</span>   2 days ago          Up 2 days               0.0.0.0:443-&gt;443/tcp, 0.0.0.0:443-&gt;443/udp    ss-libev           0B (virtual 120MB)</span><br></pre></td></tr></table></figure><p>查看端口(443)监听状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@007_centos ~]<span class="comment"># netstat -anp | grep 443</span></span><br><span class="line">tcp6       0      0 :::443                  :::*                    LISTEN      13435/docker-proxy  </span><br><span class="line">udp6       0      0 :::443                  :::*                                13446/docker-proxy</span><br></pre></td></tr></table></figure><p>至此，服务端安装完毕。</p><h2 id="windows客户端安装"><a href="#windows客户端安装" class="headerlink" title="windows客户端安装"></a>windows客户端安装</h2><p>打开 <a href="https://github.com/shadowsocks/shadowsocks-windows/releases" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-windows/releases</a> 下载最新版本客户端，截止本文编写时间，最新版本为 <a href="https://github.com/shadowsocks/shadowsocks-windows/releases/tag/4.1.9.2" target="_blank" rel="noopener">4.1.9.2</a> ，下载后直接打开对应客户端进行配置,应用确定即可。</p><p><img src="/images/shoadowsocks-windows.png" alt="shoadowsocks-windows"></p><p>如果使用chrome代理浏览器流量可以下载SwitchyOmega插件，直接安装到chrome的拓展程序里面即可</p><p>下载地址： <a href="https://github.com/FelisCatus/SwitchyOmega/releases" target="_blank" rel="noopener">https://github.com/FelisCatus/SwitchyOmega/releases</a> </p><p>插件配置如下</p><p><img src="/images/shoadowsocks-switchomega.png" alt="shoadowsocks-switchomega"></p><p>一般情况下，至此即可成功代理浏览器流量</p><h2 id="android客户端安装"><a href="#android客户端安装" class="headerlink" title="android客户端安装"></a>android客户端安装</h2><p>打开  <a href="https://github.com/shadowsocks/shadowsocks-android/releases" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-android/releases</a>  下载最新版本客户端，截止本文编写时间，最新版本为  <a href="https://github.com/shadowsocks/shadowsocks-android/releases/tag/v5.0.5" target="_blank" rel="noopener">v5.0.5</a>  ，下载后直接打开对应客户端进行配置,点击那个小飞机即可。</p><p>配置跟windows端配置类似，挺简单的，自行摸索一会儿就可以搞定。</p><p><img src="/images/shoadowsocks-android.png" alt="shoadowsocks-android"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol><li><a href="https://github.com/shadowsocks/shadowsocks-libev" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-libev</a> </li><li><a href="https://github.com/shadowsocks/shadowsocks-android" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-android</a></li><li><a href="https://github.com/shadowsocks/shadowsocks-windows" target="_blank" rel="noopener">https://github.com/shadowsocks/shadowsocks-windows</a></li><li><a href="https://hub.docker.com/r/appso/shadowsocks-libev/" target="_blank" rel="noopener">https://hub.docker.com/r/appso/shadowsocks-libev/</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;需求&quot;&gt;&lt;a href=&quot;#需求&quot; class=&quot;headerlink&quot; title=&quot;需求&quot;&gt;&lt;/a&gt;需求&lt;/h2&gt;&lt;p&gt;搭梯子翻墙访问google&lt;/p&gt;
&lt;h2 id=&quot;准备条件&quot;&gt;&lt;a href=&quot;#准备条件&quot; class=&quot;headerlink&quot; title=&quot;准备条件&quot;&gt;&lt;/a&gt;准备条件&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;一台墙外VPS（本文使用腾讯云香港 - centos7.6）&lt;/li&gt;
&lt;li&gt;一台能SSH连接到VPS的本地电脑 （推荐连接工具xshell）&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;遇到的问题&quot;&gt;&lt;a href=&quot;#遇到的问题&quot; class=&quot;headerlink&quot; title=&quot;遇到的问题&quot;&gt;&lt;/a&gt;遇到的问题&lt;/h2&gt;&lt;p&gt;因为在腾讯上直接安装使用shadowsocks遇到了”connect reset by peer”的问题，在公司访问(可直连境外)是正常的，用4g/家里wifi访问就会出现上述错误，怀疑是腾讯云做了相关网站的流量拦截，故想到这用docker再代理一层。&lt;/p&gt;
&lt;h2 id=&quot;服务端安装步骤&quot;&gt;&lt;a href=&quot;#服务端安装步骤&quot; class=&quot;headerlink&quot; title=&quot;服务端安装步骤&quot;&gt;&lt;/a&gt;服务端安装步骤&lt;/h2&gt;&lt;p&gt;安装docker&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wget -qO- get.docker.com | bash&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;查看docker的版本信息、加入开启启动、启动docker应用&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; docker&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;systemctl start docker&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;拉取docker版shadowsocks-libev&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker pull appso/shadowsocks-libev&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;创建shadowssocks配置文件，主要不要变动配置文件目录，默认配置路径为 &lt;strong&gt;/etc/shadowsocks-libev/config.json&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="shadowsocks" scheme="http://haoyunlaile.github.io/categories/shadowsocks/"/>
    
    
      <category term="shadowsocks" scheme="http://haoyunlaile.github.io/tags/shadowsocks/"/>
    
  </entry>
  
</feed>
